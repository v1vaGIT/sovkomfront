import { useState, useEffect, useRef } from 'react'

import s from './style.module.css'

import logo from '../../assets/img/logo.svg'
import avatar from '../../assets/img/avatar.svg'
import avatarMore from '../../assets/img/avatarMore.svg'

const Header = () => {
    const [showPopup, setShowPopup] = useState(false);

    const popupRef = useRef(null);
    const buttonRef = useRef(null);

    useEffect(() => {
        const handleOutsideClick = (e) => {
            if (showPopup && !popupRef.current.contains(e.target) && !buttonRef.current.contains(e.target)) {
                setShowPopup(false);
            }
        };

        document.addEventListener('mousedown', handleOutsideClick);

    }, [showPopup]);

    return (
        <div className={s.mainHeader}>
            <div className={s.mainHeader__container}>
                <div className={s.container__leftContent}>
                    <a href='/' className={s.leftContent__logo}>
                        <img src={logo}/>
                    </a>
                    <div className={s.leftContent__search}>
                        <input className={s.search__input} placeholder='Искать учебные материалы...'></input>
                        <button className={s.search__placeholder}>
                            <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M10.3333 9.33333H9.80667L9.62 9.15333C10.2959 8.36935 10.6674 7.36846 10.6667 6.33333C10.6667 5.47628 10.4125 4.63848 9.93637 3.92586C9.46022 3.21325 8.78344 2.65784 7.99163 2.32986C7.19982 2.00188 6.32853 1.91606 5.48794 2.08327C4.64736 2.25047 3.87523 2.66318 3.26921 3.26921C2.66318 3.87523 2.25047 4.64736 2.08327 5.48794C1.91606 6.32853 2.00188 7.19982 2.32986 7.99163C2.65784 8.78344 3.21325 9.46022 3.92586 9.93637C4.63848 10.4125 5.47628 10.6667 6.33333 10.6667C7.40667 10.6667 8.39333 10.2733 9.15333 9.62L9.33333 9.80667V10.3333L12.6667 13.66L13.66 12.6667L10.3333 9.33333ZM6.33333 9.33333C4.67334 9.33333 3.33334 7.99333 3.33334 6.33333C3.33334 4.67334 4.67334 3.33334 6.33333 3.33334C7.99333 3.33334 9.33333 4.67334 9.33333 6.33333C9.33333 7.99333 7.99333 9.33333 6.33333 9.33333Z" fill="#FBFBFB"/>
                            </svg>
                        </button>
                    </div>
                </div>
                <button ref={buttonRef} className={`${s.container__rightContent} ${showPopup ? s.active : ''}`} onClick={() => setShowPopup(!showPopup)}>
                    <div className={s.rightContent__avatar}>
                        <img src={avatar} alt='avatar'/>
                    </div>
                    <div className={s.rightContent__personal}>
                        <p className={s.personal__post}>Студент</p>
                        <div className={s.personal__name}>
                            <p>Евгения Остапова</p>
                            <svg width="20" height="21" viewBox="0 0 20 21" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M10 13.5L14 7.5L6 7.5L10 13.5Z" fill="white"/>
                            </svg>
                        </div>
                    </div>
                </button>
                {showPopup && (
                    <div ref={popupRef} className={s.modalMenu}>
                        <div className={s.modalMenu__menu}>
                            <a href=''>
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M12 4C10.9391 4 9.92172 4.42143 9.17157 5.17157C8.42143 5.92172 8 6.93913 8 8C8 9.06087 8.42143 10.0783 9.17157 10.8284C9.92172 11.5786 10.9391 12 12 12C13.0609 12 14.0783 11.5786 14.8284 10.8284C15.5786 10.0783 16 9.06087 16 8C16 6.93913 15.5786 5.92172 14.8284 5.17157C14.0783 4.42143 13.0609 4 12 4ZM6 8C6 6.4087 6.63214 4.88258 7.75736 3.75736C8.88258 2.63214 10.4087 2 12 2C13.5913 2 15.1174 2.63214 16.2426 3.75736C17.3679 4.88258 18 6.4087 18 8C18 9.5913 17.3679 11.1174 16.2426 12.2426C15.1174 13.3679 13.5913 14 12 14C10.4087 14 8.88258 13.3679 7.75736 12.2426C6.63214 11.1174 6 9.5913 6 8ZM8 18C7.20435 18 6.44129 18.3161 5.87868 18.8787C5.31607 19.4413 5 20.2044 5 21C5 21.2652 4.89464 21.5196 4.70711 21.7071C4.51957 21.8946 4.26522 22 4 22C3.73478 22 3.48043 21.8946 3.29289 21.7071C3.10536 21.5196 3 21.2652 3 21C3 19.6739 3.52678 18.4021 4.46447 17.4645C5.40215 16.5268 6.67392 16 8 16H16C17.3261 16 18.5979 16.5268 19.5355 17.4645C20.4732 18.4021 21 19.6739 21 21C21 21.2652 20.8946 21.5196 20.7071 21.7071C20.5196 21.8946 20.2652 22 20 22C19.7348 22 19.4804 21.8946 19.2929 21.7071C19.1054 21.5196 19 21.2652 19 21C19 20.2044 18.6839 19.4413 18.1213 18.8787C17.5587 18.3161 16.7956 18 16 18H8Z" fill="black"/>
                                </svg>
                                <p>Мой профиль</p>
                            </a>
                            <a href=''>
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M14.25 7.5H19.5V9H14.25V7.5ZM14.25 11.25H19.5V12.75H14.25V11.25ZM14.25 15H19.5V16.5H14.25V15ZM4.5 7.5H9.75V9H4.5V7.5ZM4.5 11.25H9.75V12.75H4.5V11.25ZM4.5 15H9.75V16.5H4.5V15Z" fill="black"/>
                                    <path d="M21 3.75H3C2.6023 3.7504 2.221 3.90856 1.93978 4.18978C1.65856 4.471 1.5004 4.8523 1.5 5.25V18.75C1.5004 19.1477 1.65856 19.529 1.93978 19.8102C2.221 20.0914 2.6023 20.2496 3 20.25H21C21.3977 20.2496 21.779 20.0914 22.0602 19.8102C22.3414 19.529 22.4996 19.1477 22.5 18.75V5.25C22.4996 4.8523 22.3414 4.471 22.0602 4.18978C21.779 3.90856 21.3977 3.7504 21 3.75ZM3 5.25H11.25V18.75H3V5.25ZM12.75 18.75V5.25H21V18.75H12.75Z" fill="black"/>
                                </svg>
                                <p>Мои курсы</p>
                            </a>
                            <a href=''>
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M19.5 3.1875H17.0625V2.25C17.0625 2.10082 17.0032 1.95774 16.8977 1.85225C16.7923 1.74676 16.6492 1.6875 16.5 1.6875C16.3508 1.6875 16.2077 1.74676 16.1023 1.85225C15.9968 1.95774 15.9375 2.10082 15.9375 2.25V3.1875H8.0625V2.25C8.0625 2.10082 8.00324 1.95774 7.89775 1.85225C7.79226 1.74676 7.64918 1.6875 7.5 1.6875C7.35082 1.6875 7.20774 1.74676 7.10225 1.85225C6.99676 1.95774 6.9375 2.10082 6.9375 2.25V3.1875H4.5C4.1519 3.1875 3.81806 3.32578 3.57192 3.57192C3.32578 3.81806 3.1875 4.1519 3.1875 4.5V19.5C3.1875 19.8481 3.32578 20.1819 3.57192 20.4281C3.81806 20.6742 4.1519 20.8125 4.5 20.8125H19.5C19.8481 20.8125 20.1819 20.6742 20.4281 20.4281C20.6742 20.1819 20.8125 19.8481 20.8125 19.5V4.5C20.8125 4.1519 20.6742 3.81806 20.4281 3.57192C20.1819 3.32578 19.8481 3.1875 19.5 3.1875ZM4.5 4.3125H6.9375V5.25C6.9375 5.39918 6.99676 5.54226 7.10225 5.64775C7.20774 5.75324 7.35082 5.8125 7.5 5.8125C7.64918 5.8125 7.79226 5.75324 7.89775 5.64775C8.00324 5.54226 8.0625 5.39918 8.0625 5.25V4.3125H15.9375V5.25C15.9375 5.39918 15.9968 5.54226 16.1023 5.64775C16.2077 5.75324 16.3508 5.8125 16.5 5.8125C16.6492 5.8125 16.7923 5.75324 16.8977 5.64775C17.0032 5.54226 17.0625 5.39918 17.0625 5.25V4.3125H19.5C19.5497 4.3125 19.5974 4.33225 19.6326 4.36742C19.6677 4.40258 19.6875 4.45027 19.6875 4.5V7.6875H4.3125V4.5C4.3125 4.45027 4.33225 4.40258 4.36742 4.36742C4.40258 4.33225 4.45027 4.3125 4.5 4.3125ZM19.5 19.6875H4.5C4.45027 19.6875 4.40258 19.6677 4.36742 19.6326C4.33225 19.5974 4.3125 19.5497 4.3125 19.5V8.8125H19.6875V19.5C19.6875 19.5497 19.6677 19.5974 19.6326 19.6326C19.5974 19.6677 19.5497 19.6875 19.5 19.6875ZM10.3125 11.25V17.25C10.3125 17.3992 10.2532 17.5423 10.1477 17.6477C10.0423 17.7532 9.89918 17.8125 9.75 17.8125C9.60082 17.8125 9.45774 17.7532 9.35225 17.6477C9.24676 17.5423 9.1875 17.3992 9.1875 17.25V12.1603L8.50125 12.5034C8.43514 12.5364 8.36317 12.5561 8.28947 12.5613C8.21576 12.5664 8.14176 12.5571 8.07168 12.5336C8.0016 12.5102 7.93682 12.4732 7.88103 12.4248C7.82525 12.3763 7.77956 12.3174 7.74656 12.2512C7.71357 12.1851 7.69392 12.1132 7.68874 12.0395C7.68355 11.9658 7.69294 11.8918 7.71636 11.8217C7.73977 11.7516 7.77676 11.6868 7.82522 11.631C7.87367 11.5753 7.93264 11.5296 7.99875 11.4966L9.49875 10.7466C9.58452 10.7037 9.67982 10.6836 9.77558 10.6879C9.87135 10.6923 9.96442 10.721 10.0459 10.7715C10.1275 10.8219 10.1948 10.8923 10.2414 10.9761C10.2881 11.0598 10.3125 11.1541 10.3125 11.25ZM15.8972 13.9922L13.875 16.6875H15.75C15.8992 16.6875 16.0423 16.7468 16.1477 16.8523C16.2532 16.9577 16.3125 17.1008 16.3125 17.25C16.3125 17.3992 16.2532 17.5423 16.1477 17.6477C16.0423 17.7532 15.8992 17.8125 15.75 17.8125H12.75C12.6455 17.8125 12.5431 17.7834 12.4543 17.7285C12.3654 17.6736 12.2936 17.595 12.2469 17.5016C12.2002 17.4081 12.1804 17.3035 12.1898 17.1995C12.1992 17.0954 12.2373 16.9961 12.3 16.9125L15 13.3125C15.0777 13.2103 15.1337 13.0933 15.1643 12.9686C15.195 12.844 15.1997 12.7143 15.1782 12.5878C15.1568 12.4612 15.1095 12.3404 15.0394 12.2329C14.9693 12.1253 14.8779 12.0333 14.7708 11.9625C14.6636 11.8918 14.5431 11.8437 14.4167 11.8215C14.2903 11.7992 14.1606 11.8031 14.0358 11.833C13.9109 11.8629 13.7935 11.9181 13.6909 11.9952C13.5882 12.0723 13.5025 12.1697 13.4391 12.2812C13.4055 12.3512 13.3579 12.4134 13.2991 12.4641C13.2404 12.5147 13.1718 12.5527 13.0976 12.5755C13.0235 12.5984 12.9455 12.6056 12.8684 12.5969C12.7913 12.5881 12.7169 12.5635 12.6498 12.5246C12.5827 12.4857 12.5243 12.4334 12.4784 12.3708C12.4325 12.3083 12.4001 12.237 12.3831 12.1613C12.3661 12.0856 12.3649 12.0072 12.3796 11.9311C12.3944 11.8549 12.4247 11.7826 12.4688 11.7188C12.6101 11.4761 12.7996 11.2648 13.0255 11.0979C13.2514 10.931 13.509 10.8121 13.7825 10.7483C14.056 10.6845 14.3397 10.6772 14.6161 10.7269C14.8925 10.7767 15.1559 10.8823 15.39 11.0374C15.6242 11.1926 15.8242 11.3939 15.9777 11.629C16.1313 11.8642 16.2353 12.1282 16.2832 12.4049C16.3311 12.6817 16.322 12.9653 16.2565 13.2384C16.1909 13.5115 16.0702 13.7683 15.9019 13.9931L15.8972 13.9922Z" fill="black"/>
                                </svg>
                                <p>Расписание занятий</p>
                            </a>
                            <a href=''>
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M19.5 2.4375H6.75C6.00408 2.4375 5.28871 2.73382 4.76126 3.26126C4.23382 3.78871 3.9375 4.50408 3.9375 5.25V21C3.9375 21.1492 3.99676 21.2923 4.10225 21.3977C4.20774 21.5032 4.35082 21.5625 4.5 21.5625H18C18.1492 21.5625 18.2923 21.5032 18.3977 21.3977C18.5032 21.2923 18.5625 21.1492 18.5625 21C18.5625 20.8508 18.5032 20.7077 18.3977 20.6023C18.2923 20.4968 18.1492 20.4375 18 20.4375H5.0625V20.25C5.0625 19.8024 5.24029 19.3732 5.55676 19.0568C5.87323 18.7403 6.30245 18.5625 6.75 18.5625H19.5C19.6492 18.5625 19.7923 18.5032 19.8977 18.3977C20.0032 18.2923 20.0625 18.1492 20.0625 18V3C20.0625 2.85082 20.0032 2.70774 19.8977 2.60225C19.7923 2.49676 19.6492 2.4375 19.5 2.4375ZM18.9375 17.4375H6.75C6.14132 17.4366 5.54892 17.6341 5.0625 18V5.25C5.0625 4.80245 5.24029 4.37323 5.55676 4.05676C5.87323 3.74029 6.30245 3.5625 6.75 3.5625H18.9375V17.4375Z" fill="black"/>
                                </svg>
                                <p>Учебные материалы</p>
                            </a>
                            <a href=''>
                                <svg width="24" height="25" viewBox="0 0 24 25" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M11.5 8.75C12.1071 6.28282 14.4002 5.02305 19.3929 5C19.4727 4.99969 19.5518 5.01565 19.6256 5.04695C19.6994 5.07825 19.7664 5.12427 19.8228 5.18237C19.8793 5.24047 19.924 5.30949 19.9544 5.38546C19.9848 5.46143 20.0003 5.54284 20 5.625V16.875C20 17.0408 19.936 17.1997 19.8222 17.3169C19.7083 17.4342 19.5539 17.5 19.3929 17.5C14.5357 17.5 12.6593 18.5082 11.5 20M11.5 8.75C10.8929 6.28282 8.59976 5.02305 3.60715 5C3.52733 4.99969 3.44825 5.01565 3.37445 5.04695C3.30065 5.07825 3.2336 5.12427 3.17716 5.18237C3.12072 5.24047 3.07601 5.30949 3.04561 5.38546C3.0152 5.46143 2.9997 5.54284 3 5.625V16.7996C3 17.1855 3.23224 17.5 3.60715 17.5C8.46429 17.5 10.3476 18.5156 11.5 20M11.5 8.75V20" stroke="black" strokeLinecap="round" strokeLinejoin="round"/>
                                </svg>
                                <p>Домашние занятия</p>
                            </a>
                        </div>
                        <button className={s.modalMenu__logout}>
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M17 8L15.6 9.4L17.2 11H9V13H17.2L15.6 14.6L17 16L21 12L17 8ZM5 5H12V3H5C3.9 3 3 3.9 3 5V19C3 20.1 3.9 21 5 21H12V19H5V5Z" fill="#F68588"/>
                            </svg>
                            <p>Выйти</p>
                        </button>
                    </div>
                )}
            </div>
        </div>
    );
};

export default Header;